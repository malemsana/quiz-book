<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Notebook Flashcards</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ===================== THEME ===================== */
:root {
  --bg-main: #020617;
  --bg-soft: #0f172a;
  --card: #f8fafc;
  --border: #e2e8f0;
  --q-accent: #60a5fa;
  --a-accent: #4ade80;
  --text-dark: #020617;
  --text-light: #e5e7eb;
  --muted: #94a3b8;
  --btn-bg: #1e293b;
  --btn-hover: #334155;
}

/* ===================== BASE ===================== */
* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: system-ui, -apple-system, sans-serif;
  background: radial-gradient(circle at top, #1e293b, var(--bg-main));
  color: var(--text-light);
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
}

.app {
  width: 95%;
  max-width: 580px;
  padding: 20px 0;
}

/* ===================== HEADER ===================== */
.header {
  text-align: center;
  margin-bottom: 20px;
}
.header h1 { margin: 0; font-size: 22px; }
.header p { margin-top: 6px; font-size: 14px; color: var(--muted); }

/* ===================== HOME ===================== */
.deck {
  background: #020617;
  border: 1px solid #334155;
  border-radius: 16px;
  padding: 16px;
  margin-bottom: 14px;
  cursor: pointer;
  transition: transform .15s, box-shadow .15s;
}
.deck:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 30px rgba(0,0,0,.5);
  border-color: var(--q-accent);
}
.deck h3 { margin: 0; font-size: 16px; }
.deck p { margin: 6px 0 0; font-size: 13px; color: var(--muted); }

/* ===================== CARD ===================== */
.scene { perspective: 1600px; margin-bottom: 20px; }

.card {
  position: relative;
  height: 320px;
  transform-style: preserve-3d;
  transition: transform .6s cubic-bezier(.4,0,.2,1);
  cursor: pointer;
}
.card.flip { transform: rotateY(180deg); }

.face {
  position: absolute;
  inset: 0;
  background: var(--card);
  border-radius: 20px;
  padding: 30px;
  backface-visibility: hidden;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center; 
  text-align: center;
  color: var(--text-dark);
}

.face.answer { transform: rotateY(180deg); }

/* Specific Styling */
.face.question {
  box-shadow: 0 30px 60px rgba(96,165,250,.2), inset 0 0 0 2px rgba(96,165,250,.25);
}
.face.answer {
  box-shadow: 0 30px 60px rgba(74,222,128,.2), inset 0 0 0 2px rgba(74,222,128,.25);
}

.label {
  position: absolute;
  top: 24px;
  font-size: 11px;
  font-weight: 700;
  letter-spacing: .15em;
  text-transform: uppercase;
}
.face.question .label { color: var(--q-accent); }
.face.answer .label { color: var(--a-accent); }

.content {
  font-size: 20px;
  line-height: 1.5;
  font-weight: 500;
  max-width: 100%;
  overflow-y: auto;
  max-height: 220px;
}

.hint {
  position: absolute;
  bottom: 20px;
  font-size: 12px;
  color: #64748b;
  opacity: 0.7;
}

/* ===================== CONTROLS ===================== */
.controls { display: flex; gap: 12px; }

.ctrl-btn {
  flex: 1;
  padding: 14px;
  border-radius: 12px;
  border: none;
  background: var(--btn-bg);
  color: var(--text-light);
  font-weight: 600;
  cursor: pointer;
  box-shadow: inset 0 0 0 1px #334155;
  transition: background 0.2s;
}
.ctrl-btn:hover { background: var(--btn-hover); }

.footer-nav {
  margin-top: 16px;
  text-align: center;
  font-size: 13px;
  color: var(--muted);
}

.back-btn {
  background: transparent;
  color: var(--muted);
  border: none;
  font-size: 14px;
  cursor: pointer;
  text-decoration: underline;
  margin-bottom: 10px;
  display: block;
}

/* ===================== UTILS ===================== */
.hidden { display: none !important; }
</style>
</head>

<body>

<div class="app">

  <!-- HOME SCREEN -->
  <div id="home">
    <div class="header">
      <h1>üìì Notebook Flashcards</h1>
      <p>Select a deck to begin</p>
    </div>
    <div id="deckList"></div>
  </div>

  <!-- QUIZ SCREEN -->
  <div id="quiz" class="hidden">
    
    <button class="back-btn" onclick="goHome()">‚Üê Back to list</button>

    <div class="scene">
      <div class="card" id="card">
        <!-- Front -->
        <div class="face question">
          <div class="label">Question</div>
          <div class="content" id="q"></div>
          <div class="hint">Tap to flip</div>
        </div>
        <!-- Back -->
        <div class="face answer">
          <div class="label">Answer</div>
          <div class="content" id="a"></div>
          <div class="hint">Tap to flip</div>
        </div>
      </div>
    </div>

    <div class="controls">
      <button class="ctrl-btn" id="prev">Previous</button>
      <button class="ctrl-btn" id="next">Next</button>
    </div>

    <div class="footer-nav">
      <span id="counter">Loading...</span>
    </div>
  </div>

</div>

<script>
/* ===================== CONFIG ===================== */
const DECKS = [
  {
    title: "Home Science",
    desc: "Randomized Questions",
    url: "https://cdn.jsdelivr.net/gh/malemsana/quiz-book@main/home-science.csv"
  },
  // You can add more decks here
];

/* ===================== STATE ===================== */
let currentData = [];
let index = 0;
let isFlipped = false;

/* ===================== ELEMENTS ===================== */
const home = document.getElementById("home");
const quiz = document.getElementById("quiz");
const deckList = document.getElementById("deckList");
const card = document.getElementById("card");
const qEl = document.getElementById("q");
const aEl = document.getElementById("a");
const counter = document.getElementById("counter");

/* ===================== INITIALIZE ===================== */
DECKS.forEach(deck => {
  const div = document.createElement("div");
  div.className = "deck";
  div.innerHTML = `<h3>${deck.title}</h3><p>${deck.desc}</p>`;
  div.onclick = () => loadDeck(deck);
  deckList.appendChild(div);
});

/* ===================== LOGIC ===================== */

function loadDeck(deck) {
  home.classList.add("hidden");
  quiz.classList.remove("hidden");
  
  qEl.textContent = "Loading...";
  aEl.textContent = "...";
  index = 0;
  isFlipped = false;
  card.classList.remove("flip");

  fetch(deck.url)
    .then(r => r.text())
    .then(text => {
      parseCSV(text);
      shuffleDeck(); // <--- Randomize immediately
      updateCard();
    })
    .catch(err => {
      console.error(err);
      qEl.textContent = "Error loading deck.";
    });
}

// SIMPLER PARSER: Handles "Question","Answer" correctly
function parseCSV(text) {
  const lines = text.trim().split("\n");
  
  // Remove header if present
  if (lines.length > 0 && lines[0].toLowerCase().includes("question")) {
    lines.shift();
  }

  currentData = lines.map(line => {
    // 1. Try splitting by "," (Quote-Comma-Quote)
    if (line.includes('","')) {
        const parts = line.split('","');
        // Clean up leading/trailing quotes
        const q = parts[0].replace(/^"/, "").trim(); 
        const a = parts[1] ? parts[1].replace(/"$/, "").trim() : ""; 
        return { q, a };
    } 
    // 2. Fallback for simple Comma separation
    else {
        const parts = line.split(",");
        if (parts.length < 2) return null;
        return { 
            q: parts[0].trim(), 
            a: parts.slice(1).join(",").trim() 
        };
    }
  }).filter(item => item !== null && item.q !== "");
}

function shuffleDeck() {
  for (let i = currentData.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [currentData[i], currentData[j]] = [currentData[j], currentData[i]];
  }
}

function updateCard() {
  if (currentData.length === 0) return;
  const item = currentData[index];
  qEl.textContent = item.q;
  aEl.textContent = item.a;
  counter.textContent = `${index + 1} / ${currentData.length}`;
}

/* ===================== NAVIGATION ===================== */

function nextCard() {
  if (currentData.length === 0) return;
  index = (index + 1) % currentData.length;
  resetFlip();
  setTimeout(updateCard, 150);
}

function prevCard() {
  if (currentData.length === 0) return;
  index = (index - 1 + currentData.length) % currentData.length;
  resetFlip();
  setTimeout(updateCard, 150);
}

function resetFlip() {
  isFlipped = false;
  card.classList.remove("flip");
}

function goHome() {
  quiz.classList.add("hidden");
  home.classList.remove("hidden");
  currentData = [];
}

/* ===================== EVENTS ===================== */
document.getElementById("next").onclick = nextCard;
document.getElementById("prev").onclick = prevCard;
card.onclick = () => {
  isFlipped = !isFlipped;
  card.classList.toggle("flip", isFlipped);
};

// Simple Keyboard Support
document.addEventListener("keydown", (e) => {
  if (quiz.classList.contains("hidden")) return;
  if (e.key === "ArrowRight") nextCard();
  if (e.key === "ArrowLeft") prevCard();
  if (e.key === " " || e.key === "Enter") {
    isFlipped = !isFlipped;
    card.classList.toggle("flip", isFlipped);
  }
});

</script>
</body>
</html>