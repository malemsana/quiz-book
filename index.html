<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Notebook Flashcards</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ===================== THEME ===================== */
:root {
  --bg-main: #020617;
  --bg-soft: #0f172a;
  --card: #f8fafc;
  --border: #e2e8f0;
  --q-accent: #60a5fa;
  --a-accent: #4ade80;
  --text-dark: #020617;
  --text-light: #e5e7eb;
  --muted: #94a3b8;
  --btn-bg: #1e293b;
  --btn-hover: #334155;
}

/* ===================== BASE ===================== */
* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: system-ui, -apple-system, sans-serif;
  background: radial-gradient(circle at top, #1e293b, var(--bg-main));
  color: var(--text-light);
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
}

.app {
  width: 95%;
  max-width: 580px;
  padding: 20px 0;
}

/* ===================== HEADER ===================== */
.header {
  text-align: center;
  margin-bottom: 26px;
}
.header h1 { margin: 0; font-size: 22px; }
.header p { margin-top: 6px; font-size: 14px; color: var(--muted); }

/* ===================== HOME ===================== */
.deck {
  background: #020617;
  border: 1px solid #334155;
  border-radius: 16px;
  padding: 16px;
  margin-bottom: 14px;
  cursor: pointer;
  transition: transform .15s, box-shadow .15s;
}
.deck:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 30px rgba(0,0,0,.5);
  border-color: var(--q-accent);
}
.deck h3 { margin: 0; font-size: 16px; }
.deck p { margin: 6px 0 0; font-size: 13px; color: var(--muted); }

/* ===================== TOOLBAR ===================== */
.toolbar {
  display: flex;
  justify-content: space-between;
  margin-bottom: 16px;
}
.tool-btn {
  background: transparent;
  color: var(--muted);
  border: 1px solid #334155;
  padding: 8px 12px;
  font-size: 12px;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s;
}
.tool-btn:hover {
  background: var(--btn-hover);
  color: var(--text-light);
}

/* ===================== CARD ===================== */
.scene { perspective: 1600px; margin-bottom: 20px; }

.card {
  position: relative;
  height: 320px; /* Slightly taller for mobile */
  transform-style: preserve-3d;
  transition: transform .6s cubic-bezier(.4,0,.2,1);
  cursor: pointer;
}
.card.flip { transform: rotateY(180deg); }

.face {
  position: absolute;
  inset: 0;
  background: var(--card);
  border-radius: 20px;
  padding: 30px;
  backface-visibility: hidden;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center; /* Center text visually */
  text-align: center;
  color: var(--text-dark);
  box-shadow: 0 30px 60px rgba(0,0,0,.55), inset 0 0 0 1px var(--border);
}

.face.answer { transform: rotateY(180deg); }

/* Specific Styling */
.face.question {
  box-shadow: 0 30px 60px rgba(96,165,250,.2), inset 0 0 0 2px rgba(96,165,250,.25);
}
.face.answer {
  box-shadow: 0 30px 60px rgba(74,222,128,.2), inset 0 0 0 2px rgba(74,222,128,.25);
}

.label {
  position: absolute;
  top: 24px;
  font-size: 11px;
  font-weight: 700;
  letter-spacing: .15em;
  text-transform: uppercase;
}
.face.question .label { color: var(--q-accent); }
.face.answer .label { color: var(--a-accent); }

.content {
  font-size: 20px;
  line-height: 1.5;
  font-weight: 500;
  max-width: 100%;
  overflow-y: auto;
  max-height: 220px;
}

.hint {
  position: absolute;
  bottom: 20px;
  font-size: 12px;
  color: #64748b;
  opacity: 0.7;
}

/* ===================== CONTROLS ===================== */
.controls { display: flex; gap: 12px; }

.ctrl-btn {
  flex: 1;
  padding: 14px;
  border-radius: 12px;
  border: none;
  background: var(--btn-bg);
  color: var(--text-light);
  font-weight: 600;
  cursor: pointer;
  box-shadow: inset 0 0 0 1px #334155;
  transition: background 0.2s;
}
.ctrl-btn:hover { background: var(--btn-hover); }
.ctrl-btn:active { transform: scale(0.98); }

.footer-nav {
  margin-top: 16px;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 10px;
  font-size: 13px;
  color: var(--muted);
}
.jump-link {
  color: var(--q-accent);
  text-decoration: underline;
  cursor: pointer;
}

/* ===================== UTILS ===================== */
.hidden { display: none !important; }
.loading { opacity: 0.5; pointer-events: none; }
</style>
</head>

<body>

<div class="app">

  <!-- HOME SCREEN -->
  <div id="home">
    <div class="header">
      <h1>üìì Notebook Flashcards</h1>
      <p>Select a deck to begin</p>
    </div>
    <div id="deckList"></div>
  </div>

  <!-- QUIZ SCREEN -->
  <div id="quiz" class="hidden">
    
    <!-- Top Toolbar -->
    <div class="toolbar">
      <button class="tool-btn" onclick="goHome()">‚Üê Home</button>
      <button class="tool-btn" onclick="shuffleDeck()">üîÄ Randomize</button>
    </div>

    <div class="header" style="margin-bottom: 20px;">
      <h1 id="deckTitle" style="font-size: 18px;"></h1>
    </div>

    <div class="scene">
      <div class="card" id="card">
        <!-- Front -->
        <div class="face question">
          <div class="label">Question</div>
          <div class="content" id="q"></div>
          <div class="hint">Tap to flip / Spacebar</div>
        </div>
        <!-- Back -->
        <div class="face answer">
          <div class="label">Answer</div>
          <div class="content" id="a"></div>
          <div class="hint">Tap to flip / Spacebar</div>
        </div>
      </div>
    </div>

    <div class="controls">
      <button class="ctrl-btn" id="prev">Previous</button>
      <button class="ctrl-btn" id="next">Next</button>
    </div>

    <div class="footer-nav">
      <span id="counter">Loading...</span>
      <span>‚Ä¢</span>
      <span class="jump-link" onclick="jumpToCard()">Jump to #</span>
    </div>
  </div>

</div>

<script>
/* ===================== CONFIG ===================== */
const DECKS = [
  {
    title: "Home Science",
    desc: "Basics of Home Science",
    url: "https://cdn.jsdelivr.net/gh/malemsana/quiz-book@main/home-science.csv"
  },
  // Add more decks here
];

/* ===================== STATE ===================== */
let originalData = []; // Keeps original order
let currentData = [];  // Can be shuffled
let index = 0;
let isFlipped = false;

/* ===================== ELEMENTS ===================== */
const home = document.getElementById("home");
const quiz = document.getElementById("quiz");
const deckList = document.getElementById("deckList");
const card = document.getElementById("card");
const qEl = document.getElementById("q");
const aEl = document.getElementById("a");
const counter = document.getElementById("counter");
const deckTitle = document.getElementById("deckTitle");

/* ===================== INITIALIZE ===================== */
// Render Deck List
DECKS.forEach(deck => {
  const div = document.createElement("div");
  div.className = "deck";
  div.innerHTML = `<h3>${deck.title}</h3><p>${deck.desc}</p>`;
  div.onclick = () => loadDeck(deck);
  deckList.appendChild(div);
});

/* ===================== LOGIC ===================== */

// Load and Fetch CSV
function loadDeck(deck) {
  home.classList.add("hidden");
  quiz.classList.remove("hidden");
  deckTitle.textContent = deck.title;
  qEl.textContent = "Loading...";
  aEl.textContent = "...";
  
  // Reset state
  index = 0;
  isFlipped = false;
  card.classList.remove("flip");

  fetch(deck.url)
    .then(r => {
      if (!r.ok) throw new Error("Network error");
      return r.text();
    })
    .then(text => {
      parseCSV(text);
      updateCard();
    })
    .catch(err => {
      qEl.textContent = "Error loading deck.";
      aEl.textContent = "Check console or URL.";
      console.error(err);
    });
}

// Improved CSV Parser (Handles quotes better)
function parseCSV(text) {
  const lines = text.trim().split("\n");
  // Remove header if it looks like "Question,Answer"
  if(lines[0].toLowerCase().includes("question")) lines.shift();

  originalData = lines.map(line => {
    // Regex to split by comma, ignoring commas inside quotes
    const parts = line.match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g) || [];
    // Fallback for simple splitting if regex fails or simple CSV
    if (parts.length < 2) {
        const simple = line.split(",");
        return { q: simple[0], a: simple.slice(1).join(",") }; 
    }
    
    // Clean up quotes
    const clean = (str) => str ? str.replace(/^"|"$/g, '').trim() : "";
    return { q: clean(parts[0]), a: clean(parts[1]) };
  }).filter(item => item.q && item.a); // Remove empty lines

  currentData = [...originalData]; // Copy to current
}

// Update UI
function updateCard() {
  if (currentData.length === 0) return;
  
  const item = currentData[index];
  qEl.textContent = item.q;
  aEl.textContent = item.a;
  
  counter.textContent = `${index + 1} / ${currentData.length}`;
}

// Navigation
function nextCard() {
  if (currentData.length === 0) return;
  index = (index + 1) % currentData.length;
  resetFlip();
  setTimeout(updateCard, 150); // slight delay for animation
}

function prevCard() {
  if (currentData.length === 0) return;
  index = (index - 1 + currentData.length) % currentData.length;
  resetFlip();
  setTimeout(updateCard, 150);
}

function toggleFlip() {
  isFlipped = !isFlipped;
  card.classList.toggle("flip", isFlipped);
}

function resetFlip() {
  isFlipped = false;
  card.classList.remove("flip");
}

/* ===================== FEATURES ===================== */

// 1. Shuffle
function shuffleDeck() {
  // Fisher-Yates Shuffle
  for (let i = currentData.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [currentData[i], currentData[j]] = [currentData[j], currentData[i]];
  }
  index = 0;
  resetFlip();
  updateCard();
  // Visual feedback could be added here
}

// 2. Go Home
function goHome() {
  quiz.classList.add("hidden");
  home.classList.remove("hidden");
  currentData = []; // Clear memory
}

// 3. Jump to Card
function jumpToCard() {
  const num = prompt(`Enter card number (1 - ${currentData.length}):`);
  const target = parseInt(num);
  
  if (!isNaN(target) && target >= 1 && target <= currentData.length) {
    index = target - 1;
    resetFlip();
    updateCard();
  }
}

/* ===================== EVENTS ===================== */

// Click events
document.getElementById("next").onclick = nextCard;
document.getElementById("prev").onclick = prevCard;
card.onclick = toggleFlip;

// Keyboard Shortcuts
document.addEventListener("keydown", (e) => {
  if (quiz.classList.contains("hidden")) return;
  
  switch(e.key) {
    case "ArrowRight": nextCard(); break;
    case "ArrowLeft":  prevCard(); break;
    case " ":          // Spacebar
    case "Enter":      
      e.preventDefault(); // Prevent scrolling
      toggleFlip(); 
      break;
  }
});

</script>
</body>
</html>